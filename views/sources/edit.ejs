<% include ../partials/header %>
<!-- select2 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/js/select2.min.js" integrity="sha256-FA14tBI8v+/1BtcH9XtJpcNbComBEpdawUZA6BPXRVw=" crossorigin="anonymous"></script>
<div class="row justify-content-lg-center antiflashBlock">
	<div class="col-lg-9">
			<div class="jumbotron formTitle text-center">
				<h1>Edit Source</h1>
			</div>
	</div>
</div>
<div class="container">
	<div class="row justify-content-lg-center">
		<div class="col-lg-9">
			<div class="formContainer">
			<form action="/sources/<%= source._id %>?_method=PUT" method="POST">
				<div class="form-group">
					<input class="form-control" type="text" name="source[title]" placeholder="Title" value="<%= source.title %>">
				</div>
				<div class="form-group">
					<select id="makerSelect" type-="text" name="source[makers]" style="width: 100%" multiple></select>
				</div>
				<div class="form-group">
					<textarea class="form-control" name="source[description]" placeholder="Description" rows="4"><%= source.description %></textarea>
				</div>
				<div class="form-group">
					<input class="form-control" type="text" name="source[url]" placeholder="URL" value="<%= source.url %>">
				</div>
				<div class="form-group">
					<input class="form-control" type="date" name="source[published]" value="<%= moment.utc(source.published).format('YYYY-MM-DD') %>">
				</div>
				<div class="form-group">
					<input class="form-control" type="text" name="source[slug]" placeholder="Slug" value="<%= source.slug %>">
				</div>
				<div class="form-group">
					<button type="submit" class="btn btn-primary btn-block">Update</button>
				</div>
			</form>
			</div>
		</div>
	</div>
</div>
<% include ../partials/modules/footer-scripts %>
<!-- Provide select2 with (pre)selected values, from response object -->
<script defer>
	$(document).ready(function(){
		var makers = <%- JSON.stringify(source.makers) %>;
		makers.forEach((maker) => {
			var $option = $("<option selected></option>");
			$option.val(maker._id);
			$option.text(maker.sortname);
			$("#makerSelect").append($option);
			$("#makerSelect").trigger("change");
		});
	});
</script>
<% include ../partials/modules/footer-end %>