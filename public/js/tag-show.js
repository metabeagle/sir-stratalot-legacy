$(document).ready(function(){const listObj=new List("listjsContainer",{valueNames:["linkTitle","linkKind","linkSubkind","linkMakers","linkTags","linkCreated","linkLikes","linkCost"],listClass:"listjs",sortClass:"listjsSort"});$(".linkCount").each(function(){const thisKind=$(this).closest(".filter").attr("data-filter");let kindCount;kindCount="None"===thisKind?listObj.matchingItems.length:listObj.matchingItems.filter(kind=>kind.values().linkSubkind===thisKind).length,$(this).append(kindCount),0===kindCount&&$(this).closest(".filter").addClass("noResults")}),$("#listjsSearch").on("keyup",function(){let searchString=$(this).val();listObj.search(searchString)}),$(".filter").on("click",function(){let $q=$(this).attr("data-filter");$(this).hasClass("active")?(listObj.filter(),$(".filter").removeClass("active"),$(".showAll").addClass("active")):"None"===$q?(listObj.filter(),$(".filter").removeClass("active"),$(this).addClass("active")):(listObj.filter(link=>link.values().linkSubkind===$q),$(".filter").removeClass("active"),$(this).addClass("active"))});const $listCounter=$("#listCount"),$noResults=$("#noResults");$listCounter.append(listObj.size()),listObj.on("searchComplete",function(){$listCounter.text(listObj.update().matchingItems.length),0===listObj.matchingItems.length?$noResults.show():$noResults.hide(),$(".linkCount").each(function(){let kindCount,thisKind=$(this).closest(".filter").attr("data-filter");kindCount="None"===thisKind?listObj.searchmatchingItems.length:listObj.searchmatchingItems.filter(kind=>kind.values().linkSubkind===thisKind).length,$(this).text(kindCount),0===kindCount?$(this).closest(".filter").addClass("noResults"):$(this).closest(".filter").removeClass("noResults")})}),listObj.on("filterComplete",function(){$listCounter.text(listObj.update().matchingItems.length),0===listObj.matchingItems.length?$noResults.show():$noResults.hide()}),$(".listjsSort").on("click",function(){$(".listjsSort").removeClass("active"),$(this).addClass("active"),$("#sortMenuLink").text($(this).text())}),$(".listjs").on("click",".likeButton",function(){let $thisButton=$(this),linkId=$(this).parent().prev(".linkId").html(),$likeCount=$(this).find(".likeCount"),likeData={id:linkId};$.ajax({method:"POST",contentType:"application/json",url:"../../api/links/like",data:JSON.stringify(likeData),success:function(newCount){$likeCount.text(newCount),$thisButton.toggleClass("likeButton unlikeButton"),$thisButton.find(".likeLabel").text("-1")},error:function(err){console.log(err)}}),$thisButton.on("mouseleave",function(){$thisButton.blur()})}),$(".listjs").on("click",".unlikeButton",function(){let $thisButton=$(this),linkId=$(this).parent().prev(".linkId").html(),$likeCount=$(this).find(".likeCount"),likeData={id:linkId};$.ajax({method:"POST",contentType:"application/json",url:"../../api/links/unlike",data:JSON.stringify(likeData),success:function(newCount){$likeCount.text(newCount),$thisButton.toggleClass("likeButton unlikeButton"),$thisButton.find(".likeLabel").text("+1")},error:function(err){console.log(err)}}),$thisButton.on("mouseleave",function(){$thisButton.blur()})})});